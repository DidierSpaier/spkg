#/----------------------------------------------------------------------\#
#| spkg - The Unofficial Slackware Linux Package Manager                |#
#|                                      designed by Ondøej Jirman, 2005 |#
#|----------------------------------------------------------------------|#
#|          No copy/usage restrictions are imposed on anybody.          |#
#\----------------------------------------------------------------------/#

testdir = tests

compiled-tests = \
  test-untgz \
  test-parsers \
  test-path \
  test-mkdir \
  test-rm

.PHONY: tests
tests: $(compiled-tests)

vpath %.c $(testdir) .build
objs-tests = $(foreach t,$(compiled-tests),.build/$(t).o)

test-untgz: .build/test-untgz.o

.build/test.deps:
	@mkdir -p .build
	@echo "# automatically generated file" > $@
	@( for t in $(compiled-tests) ; do echo $$t: .build/$$t.o .build/libspkg.a >> $@ ; done )

-include .build/test.deps

$(compiled-tests):
	$(CC) $^ $(LDFLAGS) -o $@

tests-clean:
	rm -f $(compiled-tests)
